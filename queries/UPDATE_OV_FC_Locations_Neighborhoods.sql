
CREATE TABLE OVFR_COL_AUX.dbo.Process_DLocalizationLevel5
    (
	[Pk_Id] [int] NOT NULL,
	[Fk_LocalizationLevel1Id] [int] NOT NULL,
	[Fk_LocalizationLevel2Id] [int] NOT NULL,
	[Fk_LocalizationLevel3Id] [int] NOT NULL,
	[Fk_LocalizationLevel4Id] [int] NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[X] [nvarchar](50) NULL,
	[Y] [nvarchar](50) NULL,
	[Z] [int] NULL,
	[SortingId] [int] NOT NULL,
	[Fk_StatusId] [tinyint] NOT NULL,
    )

INSERT INTO
	OVFR_COL_AUX.dbo.TEMP_DLocalizationLevel5 (	Pk_Id, Fk_LocalizationLevel1Id, Fk_LocalizationLevel2Id, Fk_LocalizationLevel3Id, Fk_LocalizationLevel4Id, Name, X, Y, Z, SortingId, Fk_StatusId
	)
VALUES
	(7504001,1,75,7500004,7500401,'Villa Campestre',-73.16667,7.065613,15,10,2),
	(7504002,1,75,7500004,7500401,'El Gallineral',-73.17265,7.062108,15,10,2),
	(7504003,1,75,7500004,7500401,'Casa Linda',-73.16601,7.064311,15,10,2),
	(7504004,1,75,7500004,7500401,'Río de Oro',-73.17003,7.063463,15,10,2),
	(7504005,1,75,7500004,7500401,'Villa Linda',-73.16585,7.062696,15,10,2),
	(7504006,1,75,7500004,7500401,'Balcones de Galicia',-73.16584,7.061676,15,10,2),
	(7504007,1,75,7500004,7500401,'Los Guayacanes',-73.16577,7.062212,15,10,2),
	(7504008,1,75,7500004,7500401,'Portal Campestre',-73.16750,7.061493,15,10,2),
	(7504009,1,75,7500004,7500401,'Arenales',-73.17131,7.054065,15,10,2),
	(7504010,1,75,7500004,7500401,'Santa Cruz',-73.17098,7.060369,15,10,2),
	(7504011,1,75,7500004,7500401,'Primera de Mayo',-73.16851,7.059346,15,10,2),
	(7504012,1,75,7500004,7500401,'Quinta Campestre',-73.17128,7.057221,15,10,2),
	(7504013,1,75,7500004,7500401,'Arenales Campestre',-73.17130,7.056242,15,10,2),
	(7504014,1,75,7500004,7500401,'Corviandi I',-73.16941,7.058235,15,10,2),
	(7504015,1,75,7500004,7500401,'Río Prado',-73.16768,7.056647,15,10,2),
	(7504016,1,75,7500004,7500401,'Villas de San Juan',-73.16776,7.055651,15,10,2),
	(7504017,1,75,7500004,7500401,'El Consuelo',-73.16653,7.058588,15,10,2),
	(7504018,1,75,7500004,7500401,'Arenales IV',-73.170369,7.053616,15,10,2),
	(7504019,1,75,7500004,7500401,'Altos de Arenales',-73.16809,7.054379,15,10,2),
	(7504020,1,75,7500004,7500401,'Ciudadela Villamil',-73.164898,7.058941,15,10,2),
	(7504021,1,75,7500004,7500402,'Mirador de San Juan',-73.175124,7.078957,15,10,2),
	(7504022,1,75,7500004,7500402,'Bellavista',-73.17493,7.076151,15,10,2),
	(7504023,1,75,7500004,7500402,'Corviandi III',-73.175193,7.074150,15,10,2),
	(7504024,1,75,7500004,7500402,'Quintas del llanito',-73.17410,7.072469,15,10,2),
	(7504025,1,75,7500004,7500402,'Hacienda Alcalá',-73.17284,7.069434,15,10,2),
	(7504026,1,75,7500004,7500402,'Balcones de Alejandría',-73.172564,7.076055,15,10,2),
	(7504027,1,75,7500004,7500402,'El Paraiso',-73.17876,7.074561,15,10,2),
	(7504028,1,75,7500004,7500402,'Giraluz',-73.17353,7.073342,15,10,2),
	(7504029,1,75,7500004,7500402,'Altos del llanito',-73.173024,7.072700,15,10,2),
	(7504030,1,75,7500004,7500403,'Carrizal Campestre',-73.17516,7.084525,15,10,2),
	(7504031,1,75,7500004,7500403,'San Antonio del Carrizal',-73.17428,7.082279,15,10,2),
	(7504032,1,75,7500004,7500403,'Altos del San Antonio del Carrizal',-73.17608,7.082416,15,10,2),
	(7504033,1,75,7500004,7500404,'Centro',-73.170957,7.068321,15,10,2),
	(7504034,1,75,7500004,7500404,'El Tejar',-73.17230,7.064937,15,10,2),
	(7504035,1,75,7500004,7500404,'La Cascada',-73.169440,7.069884,15,10,2),
	(7504036,1,75,7500004,7500404,'El Malecón',-73.170159,7.065132,15,10,2),
	(7504037,1,75,7500004,7500404,'La Rinconada',-73.16911,7.070549,15,10,2),
	(7504038,1,75,7500004,7500405,'Chimita zona industrial ',-73.17063,7.096237,15,10,2),
	(7504039,1,75,7500004,7500405,'El Palenque',-73.17164,7.083710,15,10,2),
	(7504040,1,75,7500004,7500405,'La Esmeralda',-73.16568,7.086442,15,10,2),
	(7504041,1,75,7500004,7500406,'Brisas de Río',-73.16926,7.077577,15,10,2),
	(7504042,1,75,7500004,7500406,'El Carmen',-73.16541,7.074453,15,10,2),
	(7504043,1,75,7500004,7500406,'Castilla la nueva',-73.17198,7.072295,15,10,2),
	(7504044,1,75,7500004,7500406,'La Isla',-73.16620,7.071268,15,10,2),
	(7504045,1,75,7500004,7500406,'El llanito',-73.17171,7.069407,15,10,2),
	(7504046,1,75,7500004,7500406,'Villa del río',-73.167522,7.069813,15,10,2),
	(7504047,1,75,7500004,7500406,'San Juan',-73.168785,7.074990,15,10,2),
	(7504048,1,75,7500004,7500406,'La Constituyente',-73.16698,7.067464,15,10,2),
	(7504049,1,75,7500004,7500406,'El Poblado',-73.16867,7.074219,15,10,2),
	(7504050,1,75,7500004,7500406,'Alicante',-73.17061,7.073359,15,10,2),
	(7504051,1,75,7500004,7500406,'La Arboleda',-73.17041,7.072670,15,10,2),
	(7504052,1,75,7500004,7500406,'San Antonio',-73.172005,7.070862,15,10,2),
	(7504053,1,75,7500004,7500406,'Carrizal',-73.16780,7.070683,15,10,2),
	(7504054,1,75,7500004,7500406,'Conjunto Res. Carrizal',-73.16736,7.070466,15,10,2),
	(7504055,1,75,7500004,7500406,'La Muralla',-73.16705,7.068396,15,10,2),
	(7504056,1,75,7500004,7500407,'La Aldea',-73.175302,7.068953,15,10,2),
	(7504057,1,75,7500004,7500407,'Aldea Baja',-73.17592,7.066853,15,10,2),
	(7504058,1,75,7500004,7500407,'Mirador de la Campiña',-73.17706,7.065563,15,10,2),
	(7504059,1,75,7500004,7500407,'Altos de la Campiña',-73.17630,7.064448,15,10,2),
	(7504060,1,75,7500004,7500407,'Sagrado Corazón',-73.17548,7.063052,15,10,2),
	(7504061,1,75,7500004,7500407,'Aldea Alta',-73.17747,7.067583,15,10,2),
	(7504062,1,75,7500004,7500407,'Villa Carolina I',-73.17676,7.068536,15,10,2),
	(7504063,1,75,7500004,7500407,'Eloy Valenzuela',-73.17411,7.066459,15,10,2),
	(7504064,1,75,7500004,7500407,'La Campiña',-73.17367,7.065576,15,10,2),
	(7504065,1,75,7500004,7500407,'Altos del Tejar',-73.17324,7.064510,15,10,2),
	(7504066,1,75,7500004,7500408,'Meseta I',-73.16579,7.057255,15,10,2),
	(7504067,1,75,7500004,7500408,'Meseta II',-73.16547,7.056467,15,10,2),
	(7504068,1,75,7500004,7500408,'Jardín de Arenales',-73.16729,7.052797,15,10,2),
	(7504069,1,75,7500004,7500408,'Villa de los Caballeros',-73.16375,7.051147,15,10,2),
	(7504070,1,75,7500004,7500408,'Villa Ampis',-73.162561,7.057804,15,10,2),
	(7504071,1,75,7500004,7500408,'Vida en Primavera',-73.16055,7.056755,15,10,2),
	(7504072,1,75,7500004,7500408,'Hacienda la Meseta',-73.159045,7.055534,15,10,2),
	(7504073,1,75,7500004,7500408,'Brisas del campo',-73.15613,7.057331,15,10,2),
	(7504074,1,75,7500004,7500408,'Bahondo',-73.169156,7.051223,15,10,2),
	(7504075,1,75,7500004,7500408,'El progreso',-73.16693,7.053493,15,10,2),
	(7504076,1,75,7500004,7500408,'Mirador de Arenales',-73.16520,7.052114,15,10,2),
	(7504077,1,75,7500004,7500408,'Los Cambulos',-73.16300,7.059820,15,10,2),
	(7504078,1,75,7500004,7500408,'Villas de Don Juan I',-73.16197,7.059233,15,10,2),
	(7504079,1,75,7500004,7500408,'Puerto Madero',-73.161055,7.058518,15,10,2),
	(7504080,1,75,7500004,7500408,'Villas de Don Juan II',-73.15782,7.057866,15,10,2),
	(7504081,1,75,7500004,7500408,'Almenares de San Juan',-73.15613,7.059231,15,10,2),
	(7504082,1,75,7500004,7500408,'Girón Campestre',-73.15840,7.059649,15,10,2),
	(7504083,1,75,7500004,7500409,'Rincón de Girón',-73.164818,7.071950,15,10,2),
	(7504084,1,75,7500004,7500409,'La Hacienda',-73.163343,7.071004,15,10,2),
	(7504085,1,75,7500004,7500409,'Castilla Real I',-73.16498,7.068833,15,10,2),
	(7504086,1,75,7500004,7500409,'Castilla Real II',-73.16505,7.066902,15,10,2),
	(7504087,1,75,7500004,7500409,'San Jorge',-73.16380,7.064259,15,10,2),
	(7504088,1,75,7500004,7500409,'Eliecer Fonseca',-73.16247,7.072752,15,10,2),
	(7504089,1,75,7500004,7500409,'Terrazas de Bellavista',-73.163452,7.069861,15,10,2),
	(7504090,1,75,7500004,7500409,'Transejes',-73.163682,7.068475,15,10,2),
	(7504091,1,75,7500004,7500409,'Portal del Río Frío',-73.163675,7.067094,15,10,2)

BEGIN TRANSACTION
UPDATE Destino
SET X = TEMP.X, Y = TEMP.Y, Fk_StatusId = 2
FROM OVFR_COL..DLocalizationLevel5 Destino
INNER JOIN (
            SELECT Pk_Id, X, Y
            FROM OVFR_COL_AUX..TEMP_DLocalizationLevel5
            WHERE Pk_Id BETWEEN 7504000 AND 7504100
) AS TEMP 
ON Destino.Pk_Id = TEMP.Pk_Id
ROLLBACK TRANSACTION
COMMIT TRANSACTION

SELECT Pk_Id, X, Y, Fk_StatusId
FROM OVFR_COL..DLocalizationLevel5
WHERE Pk_Id BETWEEN 7504000 AND 7504100



CREATE TABLE FC_COL_AUX.[dbo].Process_DLocations(
	[PK_LocationId] [int] NOT NULL,
	[Location] [varchar](100) NOT NULL,
	[Preposition] [varchar](50) NOT NULL,
	[LocationWASId] [int] NULL,
	[ParentLevel] [int] NOT NULL,
	[Weight] [tinyint] NOT NULL,
	[Map] [bit] NOT NULL,
	[Order] [int] NOT NULL,
	[Status] [tinyint] NOT NULL,
	[Latitude] [float] NOT NULL,
	[Longitude] [float] NOT NULL,
	[polygonVertex] [nvarchar](4000) NULL,
	[majorLocation] [bit] NULL,
)


INSERT INTO
	FC_COL_AUX.[dbo].TEMP_DLocations (PK_LocationId, Location, Preposition, LocationWASId, ParentLevel, Weight, Map, [Order], Status, Latitude, Longitude,polygonVertex, majorLocation
	)
VALUES
	(7504001,'Villa Campestre','',7504001,7500401,0,0,0,2,7.065613,-73.16667,'',NULL),
	(7504002,'El Gallineral','',7504002,7500401,0,0,0,2,7.062108,-73.17265,'',NULL),
	(7504003,'Casa Linda','',7504003,7500401,0,0,0,2,7.064311,-73.16601,'',NULL),
	(7504004,'Río de Oro','',7504004,7500401,0,0,0,2,7.063463,-73.17003,'',NULL),
	(7504005,'Villa Linda','',7504005,7500401,0,0,0,2,7.062696,-73.16585,'',NULL),
	(7504006,'Balcones de Galicia','',7504006,7500401,0,0,0,2,7.061676,-73.16584,'',NULL),
	(7504007,'Los Guayacanes','',7504007,7500401,0,0,0,2,7.062212,-73.16577,'',NULL),
	(7504008,'Portal Campestre','',7504008,7500401,0,0,0,2,7.061493,-73.16750,'',NULL),
	(7504009,'Arenales','',7504009,7500401,0,0,0,2,7.054065,-73.17131,'',NULL),
	(7504010,'Santa Cruz','',7504010,7500401,0,0,0,2,7.060369,-73.17098,'',NULL),
	(7504011,'Primera de Mayo','',7504011,7500401,0,0,0,2,7.059346,-73.16851,'',NULL),
	(7504012,'Quinta Campestre','',7504012,7500401,0,0,0,2,7.057221,-73.17128,'',NULL),
	(7504013,'Arenales Campestre','',7504013,7500401,0,0,0,2,7.056242,-73.17130,'',NULL),
	(7504014,'Corviandi I','',7504014,7500401,0,0,0,2,7.058235,-73.16941,'',NULL),
	(7504015,'Río Prado','',7504015,7500401,0,0,0,2,7.056647,-73.16768,'',NULL),
	(7504016,'Villas de San Juan','',7504016,7500401,0,0,0,2,7.055651,-73.16776,'',NULL),
	(7504017,'El Consuelo','',7504017,7500401,0,0,0,2,7.058588,-73.16653,'',NULL),
	(7504018,'Arenales IV','',7504018,7500401,0,0,0,2,7.053616,-73.170369,'',NULL),
	(7504019,'Altos de Arenales','',7504019,7500401,0,0,0,2,7.054379,-73.16809,'',NULL),
	(7504020,'Ciudadela Villamil','',7504020,7500401,0,0,0,2,7.058941,-73.164898,'',NULL),
	(7504021,'Mirador de San Juan','',7504021,7500402,0,0,0,2,7.078957,-73.175124,'',NULL),
	(7504022,'Bellavista','',7504022,7500402,0,0,0,2,7.076151,-73.17493,'',NULL),
	(7504023,'Corviandi III','',7504023,7500402,0,0,0,2,7.074150,-73.175193,'',NULL),
	(7504024,'Quintas del llanito','',7504024,7500402,0,0,0,2,7.072469,-73.17410,'',NULL),
	(7504025,'Hacienda Alcalá','',7504025,7500402,0,0,0,2,7.069434,-73.17284,'',NULL),
	(7504026,'Balcones de Alejandría','',7504026,7500402,0,0,0,2,7.076055,-73.172564,'',NULL),
	(7504027,'El Paraiso','',7504027,7500402,0,0,0,2,7.074561,-73.17876,'',NULL),
	(7504028,'Giraluz','',7504028,7500402,0,0,0,2,7.073342,-73.17353,'',NULL),
	(7504029,'Altos del llanito','',7504029,7500402,0,0,0,2,7.072700,-73.173024,'',NULL),
	(7504030,'Carrizal Campestre','',7504030,7500403,0,0,0,2,7.084525,-73.17516,'',NULL),
	(7504031,'San Antonio del Carrizal','',7504031,7500403,0,0,0,2,7.082279,-73.17428,'',NULL),
	(7504032,'Altos del San Antonio del Carrizal','',7504032,7500403,0,0,0,2,7.082416,-73.17608,'',NULL),
	(7504033,'Centro','',7504033,7500404,0,0,0,2,7.068321,-73.170957,'',NULL),
	(7504034,'El Tejar','',7504034,7500404,0,0,0,2,7.064937,-73.17230,'',NULL),
	(7504035,'La Cascada','',7504035,7500404,0,0,0,2,7.069884,-73.169440,'',NULL),
	(7504036,'El Malecón','',7504036,7500404,0,0,0,2,7.065132,-73.170159,'',NULL),
	(7504037,'La Rinconada','',7504037,7500404,0,0,0,2,7.070549,-73.16911,'',NULL),
	(7504038,'Chimita zona industrial ','',7504038,7500405,0,0,0,2,7.096237,-73.17063,'',NULL),
	(7504039,'El Palenque','',7504039,7500405,0,0,0,2,7.083710,-73.17164,'',NULL),
	(7504040,'La Esmeralda','',7504040,7500405,0,0,0,2,7.086442,-73.16568,'',NULL),
	(7504041,'Brisas de Río','',7504041,7500406,0,0,0,2,7.077577,-73.16926,'',NULL),
	(7504042,'El Carmen','',7504042,7500406,0,0,0,2,7.074453,-73.16541,'',NULL),
	(7504043,'Castilla la nueva','',7504043,7500406,0,0,0,2,7.072295,-73.17198,'',NULL),
	(7504044,'La Isla','',7504044,7500406,0,0,0,2,7.071268,-73.16620,'',NULL),
	(7504045,'El llanito','',7504045,7500406,0,0,0,2,7.069407,-73.17171,'',NULL),
	(7504046,'Villa del río','',7504046,7500406,0,0,0,2,7.069813,-73.167522,'',NULL),
	(7504047,'San Juan','',7504047,7500406,0,0,0,2,7.074990,-73.168785,'',NULL),
	(7504048,'La Constituyente','',7504048,7500406,0,0,0,2,7.067464,-73.16698,'',NULL),
	(7504049,'El Poblado','',7504049,7500406,0,0,0,2,7.074219,-73.16867,'',NULL),
	(7504050,'Alicante','',7504050,7500406,0,0,0,2,7.073359,-73.17061,'',NULL),
	(7504051,'La Arboleda','',7504051,7500406,0,0,0,2,7.072670,-73.17041,'',NULL),
	(7504052,'San Antonio','',7504052,7500406,0,0,0,2,7.070862,-73.172005,'',NULL),
	(7504053,'Carrizal','',7504053,7500406,0,0,0,2,7.070683,-73.16780,'',NULL),
	(7504054,'Conjunto Res. Carrizal','',7504054,7500406,0,0,0,2,7.070466,-73.16736,'',NULL),
	(7504055,'La Muralla','',7504055,7500406,0,0,0,2,7.068396,-73.16705,'',NULL),
	(7504056,'La Aldea','',7504056,7500407,0,0,0,2,7.068953,-73.175302,'',NULL),
	(7504057,'Aldea Baja','',7504057,7500407,0,0,0,2,7.066853,-73.17592,'',NULL),
	(7504058,'Mirador de la Campiña','',7504058,7500407,0,0,0,2,7.065563,-73.17706,'',NULL),
	(7504059,'Altos de la Campiña','',7504059,7500407,0,0,0,2,7.064448,-73.17630,'',NULL),
	(7504060,'Sagrado Corazón','',7504060,7500407,0,0,0,2,7.063052,-73.17548,'',NULL),
	(7504061,'Aldea Alta','',7504061,7500407,0,0,0,2,7.067583,-73.17747,'',NULL),
	(7504062,'Villa Carolina I','',7504062,7500407,0,0,0,2,7.068536,-73.17676,'',NULL),
	(7504063,'Eloy Valenzuela','',7504063,7500407,0,0,0,2,7.066459,-73.17411,'',NULL),
	(7504064,'La Campiña','',7504064,7500407,0,0,0,2,7.065576,-73.17367,'',NULL),
	(7504065,'Altos del Tejar','',7504065,7500407,0,0,0,2,7.064510,-73.17324,'',NULL),
	(7504066,'Meseta I','',7504066,7500408,0,0,0,2,7.057255,-73.16579,'',NULL),
	(7504067,'Meseta II','',7504067,7500408,0,0,0,2,7.056467,-73.16547,'',NULL),
	(7504068,'Jardín de Arenales','',7504068,7500408,0,0,0,2,7.052797,-73.16729,'',NULL),
	(7504069,'Villa de los Caballeros','',7504069,7500408,0,0,0,2,7.051147,-73.16375,'',NULL),
	(7504070,'Villa Ampis','',7504070,7500408,0,0,0,2,7.057804,-73.162561,'',NULL),
	(7504071,'Vida en Primavera','',7504071,7500408,0,0,0,2,7.056755,-73.16055,'',NULL),
	(7504072,'Hacienda la Meseta','',7504072,7500408,0,0,0,2,7.055534,-73.159045,'',NULL),
	(7504073,'Brisas del campo','',7504073,7500408,0,0,0,2,7.057331,-73.15613,'',NULL),
	(7504074,'Bahondo','',7504074,7500408,0,0,0,2,7.051223,-73.169156,'',NULL),
	(7504075,'El progreso','',7504075,7500408,0,0,0,2,7.053493,-73.16693,'',NULL),
	(7504076,'Mirador de Arenales','',7504076,7500408,0,0,0,2,7.052114,-73.16520,'',NULL),
	(7504077,'Los Cambulos','',7504077,7500408,0,0,0,2,7.059820,-73.16300,'',NULL),
	(7504078,'Villas de Don Juan I','',7504078,7500408,0,0,0,2,7.059233,-73.16197,'',NULL),
	(7504079,'Puerto Madero','',7504079,7500408,0,0,0,2,7.058518,-73.161055,'',NULL),
	(7504080,'Villas de Don Juan II','',7504080,7500408,0,0,0,2,7.057866,-73.15782,'',NULL),
	(7504081,'Almenares de San Juan','',7504081,7500408,0,0,0,2,7.059231,-73.15613,'',NULL),
	(7504082,'Girón Campestre','',7504082,7500408,0,0,0,2,7.059649,-73.15840,'',NULL),
	(7504083,'Rincón de Girón','',7504083,7500409,0,0,0,2,7.071950,-73.164818,'',NULL),
	(7504084,'La Hacienda','',7504084,7500409,0,0,0,2,7.071004,-73.163343,'',NULL),
	(7504085,'Castilla Real I','',7504085,7500409,0,0,0,2,7.068833,-73.16498,'',NULL),
	(7504086,'Castilla Real II','',7504086,7500409,0,0,0,2,7.066902,-73.16505,'',NULL),
	(7504087,'San Jorge','',7504087,7500409,0,0,0,2,7.064259,-73.16380,'',NULL),
	(7504088,'Eliecer Fonseca','',7504088,7500409,0,0,0,2,7.072752,-73.16247,'',NULL),
	(7504089,'Terrazas de Bellavista','',7504089,7500409,0,0,0,2,7.069861,-73.163452,'',NULL),
	(7504090,'Transejes','',7504090,7500409,0,0,0,2,7.068475,-73.163682,'',NULL),
	(7504091,'Portal del Río Frío','',7504091,7500409,0,0,0,2,7.067094,-73.163675,'',NULL)

BEGIN TRANSACTION
UPDATE Destino
SET Latitude = TEMP.Latitude, Longitude = TEMP.Longitude, [Status] = 2
FROM FC_COL_WRT..DLocations Destino
INNER JOIN (
            SELECT Pk_LocationId, Latitude, Longitude
            FROM FC_COL_AUX.[dbo].TEMP_DLocations
            WHERE PK_LocationId BETWEEN 7504000 AND 7504100
) AS TEMP 
ON Destino.PK_LocationId = TEMP.PK_LocationId
ROLLBACK TRANSACTION
COMMIT TRANSACTION

SELECT Pk_LocationId, Latitude, Longitude, [Status]
FROM FC_COL_WRT..DLocations
WHERE PK_LocationId BETWEEN 7504000 AND 7504100