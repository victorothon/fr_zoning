--- CREATE ZONE PROCESS TABLE IN OV ---

CREATE TABLE OVFR_COL_AUX..Process_DLocalizationLevel4(
	[Pk_Id] [int] NOT NULL,
	[Fk_LocalizationLevel1Id] [int] NOT NULL,
	[Fk_LocalizationLevel2Id] [int] NOT NULL,
	[Fk_LocalizationLevel3Id] [int] NOT NULL,
	[Name] [nvarchar](50) NOT NULL,
	[X] [nvarchar](50) NULL,
	[Y] [nvarchar](50) NULL,
	[Z] [int] NULL,
	[SortingId] [int] NOT NULL,
	[Fk_StatusId] [tinyint] NOT NULL,
	[polygonVertex] [varchar](max) NULL
)


--- INSERT DATA INTO PROCESS TABLE IN OV ---

INSERT INTO
	OVFR_COL_AUX..Process_DLocalizationLevel4 (	Pk_Id,Fk_LocalizationLevel1Id,Fk_LocalizationLevel2Id,Fk_LocalizationLevel3Id,Name,X,Y,Z,SortingId,Fk_StatusId
	)
VALUES
	(7200101,1,72,7200003,'ZONA MARIA EUGENIA - PANDO',-74.206123,11.219027,15,120,2),
	(7200102,1,72,7200003,'ZONA CENTRAL',-74.210072,11.237422,15,120,2),
	(7200103,1,72,7200003,'ZONA PESCAITO',-74.19036,11.260819,15,120,2),
	(7200104,1,72,7200003,'ZONA POLIDEPORTIVO - EL JARDIN',-74.196124,11.240831,15,120,2),
	(7200105,1,72,7200003,'ZONA SANTA FE - BASTIDAS',-74.179687,11.238937,15,120,2),
	(7200106,1,72,7200003,'ZONA PARQUE - 11 DE NOVIEMBRE',-74.171405,11.231108,16,120,2),
	(7200107,1,72,7200003,'ZONA RODADERO - GAIRA',-74.221315,11.191958,14,120,2),
	(7200108,1,72,7200003,'ZONA POZO COLORADO - PIEDRA INCA',-74.220586,11.14366,15,120,2),
	(7200109,1,72,7200003,'ZONA BURECHE LA CONCEPCIÓN',-74.176508,11.216646,15,120,2),
	(7200110,1,72,7200003,'ZONA CORREGIMIENTO BONDA',-74.111081,11.235532,14,120,2),
	(7200111,1,72,7200003,'ZONA CORREGIMIENTO GUACHACA',-73.838429,11.245393,13,120,2),
	(7200112,1,72,7200003,'ZONA CORREGIMIENTO MINCA',-74.120121,11.151287,13,120,2),
	(7200113,1,72,7200003,'ZONA CORREGIMIENTO TAGANGA',-74.189629,11.268575,15,120,2)


--- CLEAR DATA FROM FC PROCESS TABLE ---

TRUNCATE TABLE FC_COL_AUX..Process_DLocations


--- INSERT DATA INTO FC PROCESS TABLE ---

INSERT INTO
	FC_COL_AUX..Process_DLocations (PK_LocationId, Location, Preposition, LocationWASId, ParentLevel, Weight, Map, [Order], Status, Latitude, Longitude,polygonVertex, majorLocation
	)
VALUES
	(7200101,'ZONA MARIA EUGENIA - PANDO','',7200101,7200003,0,0,0,2,11.219027,-74.206123,'',NULL),
	(7200102,'ZONA CENTRAL','',7200102,7200003,0,0,0,2,11.237422,-74.210072,'',NULL),
	(7200103,'ZONA PESCAITO','',7200103,7200003,0,0,0,2,11.260819,-74.19036,'',NULL),
	(7200104,'ZONA POLIDEPORTIVO - EL JARDIN','',7200104,7200003,0,0,0,2,11.240831,-74.196124,'',NULL),
	(7200105,'ZONA SANTA FE - BASTIDAS','',7200105,7200003,0,0,0,2,11.238937,-74.179687,'',NULL),
	(7200106,'ZONA PARQUE - 11 DE NOVIEMBRE','',7200106,7200003,0,0,0,2,11.231108,-74.171405,'',NULL),
	(7200107,'ZONA RODADERO - GAIRA','',7200107,7200003,0,0,0,2,11.191958,-74.221315,'',NULL),
	(7200108,'ZONA POZO COLORADO - PIEDRA INCA','',7200108,7200003,0,0,0,2,11.14366,-74.220586,'',NULL),
	(7200109,'ZONA BURECHE LA CONCEPCIÓN','',7200109,7200003,0,0,0,2,11.216646,-74.176508,'',NULL),
	(7200110,'ZONA CORREGIMIENTO BONDA','',7200110,7200003,0,0,0,2,11.235532,-74.111081,'',NULL),
	(7200111,'ZONA CORREGIMIENTO GUACHACA','',7200111,7200003,0,0,0,2,11.245393,-73.838429,'',NULL),
	(7200112,'ZONA CORREGIMIENTO MINCA','',7200112,7200003,0,0,0,2,11.151287,-74.120121,'',NULL),
	(7200113,'ZONA CORREGIMIENTO TAGANGA','',7200113,7200003,0,0,0,2,11.268575,-74.189629,'',NULL)


--- UPDATE DATA IN FC_COL_WRT_DLocations ---

UPDATE Destino
SET [Location]      = TEMP.Location,
	[Preposition]   = TEMP.Preposition,
	[LocationWASId] = TEMP.LocationWASId,
	[ParentLevel]   = TEMP.ParentLevel,
	[Weight]        = TEMP.Weight,
	[Map]           = TEMP.Map,
	[Order]         = TEMP.[Order],
	[Status]        = TEMP.Status,
	[Latitude]      = TEMP.Latitude,
	[Longitude]     = TEMP.Longitude,
	[polygonVertex] = TEMP.polygonVertex,
	[majorLocation] = TEMP.majorLocation
FROM FC_COL_WRT..DLocations Destino (NOLOCK)
INNER JOIN FC_COL_AUX..Process_DLocations TEMP
    ON Destino.PK_LocationId = TEMP.PK_LocationId
WHERE Destino.PK_LocationId BETWEEN 7200101 AND 7200113


--- UPDATE DATA IN ovfr_COL_WRT_DLocationsLevel4 ---

UPDATE Destino
SET [Fk_LocalizationLevel1Id]   = TEMP.Fk_LocalizationLevel1Id,
	[Fk_LocalizationLevel2Id]   = TEMP.Fk_LocalizationLevel2Id,
	[Fk_LocalizationLevel3Id]   = TEMP.Fk_LocalizationLevel3Id,
	[Name]                      = TEMP.Name,
	[X]                         = TEMP.X,
	[Y]                         = TEMP.Y,
	[Z]                         = TEMP.Z,
	[SortingId]                 = TEMP.SortingId,
	[Fk_StatusId]               = TEMP.Fk_StatusId
FROM OVFR_COL..DLocalizationLevel4 Destino (NOLOCK)
INNER JOIN OVFR_COL_AUX..Process_DLocalizationLevel4 TEMP
    ON Destino.Pk_Id = TEMP.Pk_Id
WHERE Destino.Pk_Id BETWEEN 7200101 AND 7200113